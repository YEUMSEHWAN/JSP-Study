package com.boardone;

import java.sql.*;

public class BoardDAO {

	private static BoardDAO instance = null;

	private BoardDAO() {
	}

	public static BoardDAO getInstance() {

		if (instance == null) {
			synchronized (BoardDAO.class) {
				instance = new BoardDAO();
			}
		}
		return instance;
	}

	// 이곳에서 부터 게시판 작업 기능을 하나씩 메소드를 추가해 작성하면 됨.
	// 글을 데이터베이스에 추가하는 메소드
	public void insertArticle(BoardVO article) {
		
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		
		int num =article.getNum();
		int ref =article.getRef();
		int step =article.getStep();
		int depth =article.getDepth();
		
		int number = 0;
		String strQuery = "";
		
		
		try {
			
			conn = ConnUtil.getConnection();
			pstmt = conn.prepareStatement("select max(num) from board");
			rs = pstmt.executeQuery();
			
			if(rs.next())number = rs.getInt(1) +1;
			else number =1;	
			
			if(num !=0) {//0이 아닌경우에는 답변글임.
				strQuery = "";
				
			}else {//새 글일 경우
				ref = number;
				step = 0;
				depth = 0;
			}
			strQuery = "";
			
			
		}catch (SQLException s1) {
			s1.printStackTrace();
		} finally {
			if (rs != null)
				try {
					rs.close();
				} catch (SQLException s1) {
				}
			if (pstmt != null)
				try {
					pstmt.close();
				} catch (SQLException s2) {
				}
			if (conn != null)
				try {
					conn.close();
				} catch (SQLException s3) {
				}
		}
		return ;
		
		
		
		
	}

}
